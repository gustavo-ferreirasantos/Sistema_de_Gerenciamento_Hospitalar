<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>Resultado do Atendimento</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-5">

  <div class="card shadow p-4">

    <h3 class="mb-4">
      Resultado do <span th:text="${tipo}"></span>
    </h3>

    <!-- ===================== INFORMAÇÕES COMUNS ===================== -->

    <p><strong>Data:</strong>
      <span th:text="${#temporals.format(agendamento.data, 'dd/MM/yyyy HH:mm')}"></span>
    </p>

    <p><strong>Paciente:</strong>
      <span th:text="${agendamento.paciente.nome}"></span>
    </p>

    <p><strong>Médico(a) Responsável:</strong>
      <span th:text="${agendamento.medico.nome}"></span>
    </p>

    <hr>

    <h4>Informações do Atendimento</h4>
    <p><strong>Nome:</strong> <span th:text="${agendamento.informacoes.nome}"></span></p>
    <p><strong>Descrição:</strong> <span th:text="${agendamento.informacoes.descricao}"></span></p>

    <hr>

    <!-- ======================== CONSULTA =========================== -->
    <div th:if="${tipo == 'Consulta'}">
      <h4>Diagnóstico</h4>
      <p th:text="${agendamento.diagnostico != null ? agendamento.diagnostico : 'Nenhum diagnóstico informado'}"></p>

      <h4>Retorno Necessário</h4>
      <p th:text="${agendamento.retornoNecessario ? 'Sim' : 'Não'}"></p>
    </div>

    <!-- ========================= EXAME ============================= -->
    <div th:if="${tipo == 'Exame'}">

      <h4>Laudo</h4>

      <div th:if="${agendamento.laudo != null}">
        <a class="btn btn-primary mb-3"
           th:href="@{'/agendamentos/resultado/exame/laudo/' + ${agendamento.id}}">
          Baixar Laudo
        </a>

        <iframe
                th:src="@{'/agendamentos/resultado/exame/laudo/' + ${agendamento.id}}"
                width="100%"
                height="600px"
                style="border: 1px solid #ccc; border-radius: 5px;">
        </iframe>

      </div>

      <p th:if="${agendamento.laudo == null}" class="text-muted">
        Nenhum laudo enviado para este exame.
      </p>
    </div>

    <!-- ====================== PROCEDIMENTO ========================== -->
    <div th:if="${tipo == 'Procedimento'}">
      <h4>Diagnóstico</h4>
      <p th:text="${agendamento.diagnostico}"></p>

      <h4>Remédios</h4>
      <p th:text="${agendamento.remedios}"></p>

      <h4>Riscos e Observações</h4>
      <p th:text="${agendamento.riscos_observacoes}"></p>
    </div>

    <hr>

    <a th:href="@{'/dashboard/' + ${agendamento.paciente.id}}" class="btn btn-secondary mt-3">
      Voltar ao Painel
    </a>

  </div>
</div>

</body>
</html>
